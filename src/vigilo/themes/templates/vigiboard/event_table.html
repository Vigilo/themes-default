<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude">

<xi:include href="vigiboard.html" />

<?python from genshi import HTML ?>
<?python from vigilo.models import StateName ?>
<?python from vigiboard.controllers.vigiboard_plugin import VigiboardRequestPlugin ?>

<head> 
    <title>Vigiboard - ${l_('Event table')}</title>
</head>

<body>
	<table class="vigitable" summary="Event table" py:with="columns_count = sum([p[1].get_generated_columns_count() for p in plugins])">
		<thead>
	        <tr id="vigitable_navigation_bar">
	            <th class="navigation_arrow">
					<img src="${tg.url('/images/rounded_left.png')}"/>
	            </th>
	
	            <th colspan="${columns_count - 2}" id="table_title">
	          	    <span>
	          			${l_('Events table')}
			        </span>
	            </th>
	
	            <th class="navigation_arrow">
					<img src="${tg.url('/images/rounded_right.png')}"/>
	            </th>
	        </tr>
	
			<tr class="plugins">
	            <py:for each="(plugin_name, plugin_instance) in plugins">
	                <xi:include href="vigiboard_plugin/${plugin_name}.html"/>
	                ${header_template(plugin_name, plugin_instance)}
	            </py:for>
			</tr>
		</thead>
		<tfoot>
	        <tr id="vigitable_navigation_bar">
	            <th class="navigation_arrow">
		        <py:choose><!--!
			     --><img py:when="page == 1" src="${tg.url('/images/dis_arrow_left.png')}" alt="Previous" title="Previous page" /><!--!
			     --><a py:otherwise="" href="${tg.url('/%d' % (page-1))}"><!--!
			         --><img src="${tg.url('/images/left_arrow.png')}" alt="Previous" title="Previous page"/><!--!
			     --></a>
			    </py:choose>
	            </th>
	
	            <th colspan="${columns_count - 2}" id="pagination">
	          	    <span>
	          		${l_('Showing rows %(id_first_row)d to %(id_last_row)d of %(total_rows)d') % rows_info}
	          		<py:if test="nb_pages > 1">
	          		    <br/>
			            Pages 
			            <py:for each="p in range(1, nb_pages + 1)">
			                <a py:if="p != page" href="${tg.url('/%d' % p)}" py:content="p" />
			                <span py:if="p == page" py:replace="p" />
			            </py:for>
			        </py:if>
			        </span>
	            </th>
	
	            <th class="navigation_arrow">
		        <py:choose><!--!
			     --><img py:when="page >= nb_pages" src="${tg.url('/images/dis_arrow_right.png')}"  alt="Next" title="Next page" /><!--!
			     --><a py:otherwise="" href="${tg.url('/%d' % (page+1))}"><!--!
			         --><img src="${tg.url('/images/right_arrow.png')}" alt="Next" title="Next page"/><!--!
			     --></a>
			    </py:choose>
	            </th>
	        </tr>
		</tfoot>
	
		<tbody py:choose="not rows_info['total_rows']">
			<tr py:when="1">
			    <td colspan="${columns_count}">There are no events.</td>
			</tr>
	
	        <tr py:when="0" py:for="(index, event) in enumerate(events)" class="${['odd', 'even'][index % 2]}">
	            <py:for each="(plugin_name, plugin_instance) in plugins">
	                <xi:include href="vigiboard_plugin/${plugin_name}.html"/>
	                ${data_template(plugin_name, plugin_instance, event)}
	            </py:for>
	        </tr>
		</tbody>
	</table>
</body>

<div style="display: none"> 
    <py:for each="(plugin_name, plugin_instance) in plugins">
        <xi:include href="vigiboard_plugin/${plugin_name}.html" /> 
        ${plugin_template(plugin_name, plugin_instance)}
    </py:for>
</div>

</html>
